# Circle 초대 링크/코드 - 상세 기능 기획서

## 기능 개요
Circle 생성자가 1회용 초대 링크와 6자리 코드를 생성하여 친구들을 Circle에 초대하고, 앱 미설치자도 쉽게 참여할 수 있도록 하는 기능

## 상세 기능 명세

### 1. Circle 생성 및 초대 코드 발급

#### 1.1 Circle 생성 플로우
1. **Profile 탭** → **새 Circle 만들기** 버튼
2. **Circle 이름 입력** (최대 20자)
3. **인원 제한 설정** (10명/25명/50명 중 선택)
4. **유효 기간 설정** (기본값: 24시간, 변경 불가)
5. **Circle 생성** 버튼 터치
6. **초대 링크 & 코드 자동 생성**

#### 1.2 초대 링크/코드 생성 규칙
- **초대 링크**: `https://circly.app/join/{unique_id}`
- **6자리 코드**: 숫자+영문 대문자 조합 (예: A1B2C3)
- **유효기간**: 24시간 (생성 시점부터)
- **사용 횟수**: 설정된 인원 제한까지
- **보안**: UUID v4 기반 고유 식별자 사용

### 2. 초대 링크/코드 공유

#### 2.1 공유 방식
1. **링크 복사**: 클립보드에 링크 복사
2. **코드 복사**: 6자리 코드만 복사
3. **카카오톡 공유**: 딥링크 포함된 메시지
4. **인스타그램 스토리**: 예쁜 초대 카드 이미지
5. **기타 앱 공유**: 시스템 공유 시트 활용

#### 2.2 공유 메시지 템플릿
```
🎉 Circly에서 익명 투표해요!
Circle: [Circle 이름]
코드: [6자리 코드]
링크: [초대 링크]

24시간 후 만료되니 지금 바로 참여하세요! 📱
```

### 3. 초대 링크 접속 및 앱 설치 플로우

#### 3.1 앱 설치된 사용자
1. 초대 링크 클릭
2. Circly 앱 자동 실행
3. Circle 정보 표시 및 참여 확인
4. **참여하기** 버튼 터치
5. 닉네임 입력 (최대 10자, 중복 확인)
6. Circle 입장 완료
7. Home 탭으로 이동

#### 3.2 앱 미설치 사용자
1. 초대 링크 클릭
2. 웹 랜딩 페이지 표시
   - Circle 정보 미리보기
   - "지금 참여하려면 앱 설치" 메시지
   - App Store/Google Play 다운로드 버튼
3. 앱 설치 완료 후 자동 실행
4. 딥링크로 해당 Circle 정보 전달
5. 닉네임 입력 후 Circle 입장

### 4. 6자리 코드로 참여

#### 4.1 코드 입력 플로우
1. **Home 탭** → **코드로 참여** 버튼
2. 6자리 코드 입력 UI
   - 숫자/영문 자동 대문자 변환
   - 실시간 입력 검증
   - 잘못된 형식 시 에러 표시
3. **참여하기** 버튼 터치
4. Circle 정보 확인 화면
5. 닉네임 입력 후 참여 완료

### 5. Circle 관리 기능

#### 5.1 생성자 관리 기능
- **링크/코드 재발급**: 기존 링크 무효화 후 새로 생성
- **Circle 삭제**: 모든 데이터 삭제 및 멤버 퇴장
- **멤버 목록 확인**: 참여자 닉네임 리스트 (최대 50명까지)
- **참여 통계**: 링크 클릭 수, 실제 참여 수, 전환율

#### 5.2 멤버 관리
- **멤버 강제 퇴장**: 부적절한 행동 시 생성자가 추방 가능
- **닉네임 변경**: 참여 후에도 닉네임 변경 가능 (24시간 1회)

### 6. 딥링크 및 Universal Link 구현

#### 6.1 딥링크 스키마
- iOS: `circly://join?code={code}&circle_id={id}`
- Android: `intent://join?code={code}&circle_id={id}#Intent;scheme=circly;package=com.circly.app;end`
- Universal Link: `https://circly.app/join/{unique_id}`

#### 6.2 딥링크 처리 로직
1. 앱 실행 시 딥링크 파라미터 확인
2. 유효한 Circle 코드인지 검증
3. 이미 참여한 Circle인지 확인
4. 적절한 화면으로 라우팅

### 7. 보안 및 악용 방지

#### 7.1 보안 메커니즘
- **Rate Limiting**: IP당 시간당 최대 10회 Circle 생성 제한
- **중복 참여 방지**: 디바이스 ID 기반 중복 참여 차단
- **코드 추측 방지**: 충분한 엔트로피의 랜덤 코드 생성
- **만료 시간 엄격 적용**: 24시간 경과 시 즉시 무효화

### 8. 에러 케이스 및 예외 처리

#### 8.1 초대 링크/코드 오류
- **만료된 링크**: "이 초대는 만료되었습니다. 새로운 초대를 요청하세요."
- **잘못된 코드**: "올바르지 않은 코드입니다. 다시 확인해주세요."
- **인원 초과**: "이미 정원이 찼습니다. 다음 기회에 참여해주세요."
- **이미 참여함**: "이미 이 Circle에 참여하고 있습니다."

#### 8.2 네트워크 및 시스템 오류
- **네트워크 오류**: 오프라인 상태 감지 및 재시도 옵션 제공
- **서버 오류**: "서버 연결에 문제가 있습니다. 잠시 후 다시 시도해주세요."

### 9. 분석 및 추적

#### 9.1 추적 이벤트
- 초대 링크 생성
- 초대 링크 클릭 (어떤 플랫폼에서)
- 앱 설치 후 Circle 참여 (전환율 측정)
- 6자리 코드 입력 시도/성공
- Circle 참여 완료

#### 9.2 성과 지표
- 링크 클릭 → 앱 설치 전환율: 30% 목표
- 앱 설치 → Circle 참여 전환율: 80% 목표
- 코드 입력 성공률: 85% 목표

## 개발 우선순위
1. **Phase 1**: 기본 Circle 생성 및 초대 링크 발급
2. **Phase 2**: 6자리 코드 시스템 및 딥링크 처리
3. **Phase 3**: 웹 랜딩 페이지 및 앱스토어 연동
4. **Phase 4**: 보안 강화 및 악용 방지 시스템